<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Statistical Models • snafun</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Statistical Models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">snafun</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2024.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Creating-a-graph-object.html">Creating a graph object</a></li>
    <li><a class="dropdown-item" href="../articles/Manipulating-the-graph-object.html">Manipulating the graph object</a></li>
    <li><a class="dropdown-item" href="../articles/Converting-between-graph-classes.html">Converting between graph classes</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Network measures</h6></li>
    <li><a class="dropdown-item" href="../articles/Graph-level-indices.html">Graph level indices</a></li>
    <li><a class="dropdown-item" href="../articles/Dyad-level-indices.html">Dyad-level indices</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Statistical Models</h6></li>
    <li><a class="dropdown-item" href="../articles/Statistical-models.html">Statistical Models</a></li>
    <li><a class="dropdown-item" href="../articles/ERGMs.html">Exponential Random Graph Models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Temporal network analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/ERGM-for-temporal-networks.html">ERGM for temporal networks</a></li>
    <li><a class="dropdown-item" href="../articles/Temporal-networks-exploration.html">Temporal networks exploration and description</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Plotting the graph</h6></li>
    <li><a class="dropdown-item" href="../articles/Plotting.html">Plotting</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SNAnalyst/SNAfun/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Statistical Models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SNAnalyst/SNAfun/blob/HEAD/vignettes/Statistical-models.Rmd" class="external-link"><code>vignettes/Statistical-models.Rmd</code></a></small>
      <div class="d-none name"><code>Statistical-models.Rmd</code></div>
    </div>

    
    
<style type="text/css">
.main-container {
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
}
</style>
<style type="text/css">
pre {
    border-style: hidden;
}
</style>
<div class="section level2">
<h2 id="statistical-models">Statistical models<a class="anchor" aria-label="anchor" href="#statistical-models"></a>
</h2>
<div class="section level3">
<h3 id="overview-table">Overview table<a class="anchor" aria-label="anchor" href="#overview-table"></a>
</h3>
<p>Here is an overview of the statistical models discussed in the
course.</p>
<p><br></p>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Titan+One:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #BEBEBE;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #BEBEBE;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}

#mwlefoodfi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mwlefoodfi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="font-family: 'Titan One'; font-size: xx-large; text-align: center;">Statistical network models</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="When">When</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Which approach">Which approach</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Function">Function</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="When" class="gt_row gt_left">Dependent vertex attribute explained by a network weight matrix and a matrix of covariates</td>
<td headers="Which approach" class="gt_row gt_left">Network autocorrelation model</td>
<td headers="Function" class="gt_row gt_left"><span class="gt_from_md"><pre><code><span><span class="fu">snafun</span><span class="fu">::</span><span class="va"><a href="../reference/stat_nam.html">stat_nam</a></span></span></code></pre>
</span></td>
</tr>
<tr>
<td headers="When" class="gt_row gt_left">A statistic on a single network</td>
<td headers="Which approach" class="gt_row gt_left">Conditional Uniform Graph test</td>
<td headers="Function" class="gt_row gt_left"><span class="gt_from_md"><pre><code><span><span class="fu">sna</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/sna/man/cug.test.html" class="external-link">cug.test</a></span></span></code></pre>
</span></td>
</tr>
<tr>
<td headers="When" class="gt_row gt_left">Association between two networks</td>
<td headers="Which approach" class="gt_row gt_left">QAP</td>
<td headers="Function" class="gt_row gt_left"><span class="gt_from_md"><pre><code><span><span class="fu">sna</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/sna/man/qaptest.html" class="external-link">qaptest</a></span></span></code></pre>
</span></td>
</tr>
<tr>
<td headers="When" class="gt_row gt_left">A valued dependent network explained by one or more explanatory networks</td>
<td headers="Which approach" class="gt_row gt_left">QAP linear model</td>
<td headers="Function" class="gt_row gt_left"><span class="gt_from_md"><pre><code><span><span class="fu">sna</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/sna/man/netlm.html" class="external-link">netlm</a></span></span></code></pre>
</span></td>
</tr>
<tr>
<td headers="When" class="gt_row gt_left">A binary dependent network explained by one or more explanatory networks</td>
<td headers="Which approach" class="gt_row gt_left">QAP logistic model</td>
<td headers="Function" class="gt_row gt_left"><span class="gt_from_md"><pre><code><span><span class="fu">sna</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/sna/man/netlogit.html" class="external-link">netlogit</a></span></span></code></pre>
</span></td>
</tr>
<tr>
<td headers="When" class="gt_row gt_left">A binary or valued dependent network explained by a set of endogenous and exogenous variables</td>
<td headers="Which approach" class="gt_row gt_left">Exponential random graph models</td>
<td headers="Function" class="gt_row gt_left"><span class="gt_from_md"><pre><code><span><span class="fu">ergm</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ergm/man/ergm.html" class="external-link">ergm</a></span></span></code></pre>
</span></td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="network-autocorrelation-models">Network autocorrelation models<a class="anchor" aria-label="anchor" href="#network-autocorrelation-models"></a>
</h3>
<p>The network autocorrelation model is run through the
<code><a href="../reference/stat_nam.html">snafun::stat_nam</a></code> function. The implementation is
appropriate for continuous dependent variables.</p>
<p>The basic function call is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">snafun</span><span class="fu">::</span><span class="fu"><a href="../reference/stat_nam.html">stat_nam</a></span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">W</span>,</span>
<span>  W2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lag"</span>, <span class="st">"error"</span>, <span class="st">"combined"</span><span class="op">)</span>,</span>
<span>  <span class="va">na.action</span>,</span>
<span>  Durbin <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  zero.policy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  check_vars <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here,</p>
<ul>
<li><p><code>formula</code> is a formula of the form
<code>DEP ~ EXO1 + EXO2 + EXO3</code> or <code>DEP ~ .</code> This
follows the standard way of formulating formulas in R. Run
<code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">?stats::formula</a></code> in your console for details.</p></li>
<li><p><code>data</code> is a <code>data.frame</code> or a
<code>list</code> containing the variables to be included into the
model.</p></li>
<li><p><code>W</code> is a matrix of the same dimension as the network,
containing the weights that drive the network influence process (for the
<code>lag</code> model) or the network disturbances process (for the
<code>error</code> model).</p></li>
<li><p><code>W2</code> is a matrix of the same dimension as the network,
containing the weights that drive the network disturbances when running
a <code>combined</code> model.</p></li>
</ul>
<p>An intercept is added to the model by default, it is best to NOT
include this as a separate exogenous variable.</p>
<p>The weigh matrix (matrices) is (are) row-normalized by this function.
If you want to run the model using non-standardized weight matrices, use
the <code><a href="https://rdrr.io/pkg/sna/man/lnam.html" class="external-link">sna::lnam</a></code> function instead.</p>
<p>The <code>snafun</code> package provides a useful
<code>stat_nam_summary</code> method (that shows you an overview of the
results) and a <code>plot_nam</code> method (that you use to check model
assumptions).</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="conditional-uniform-graphs-cug">Conditional Uniform graphs (CUG)<a class="anchor" aria-label="anchor" href="#conditional-uniform-graphs-cug"></a>
</h3>
<p>There are two methods to perform a conditional Uniform graph
test.</p>
<p>The first is to generate the graphs manually and calculate the
measures on each graph. Generation of these graphs can be done using
<code><a href="../reference/create_random_graph.html">snafun::create_random_graph</a></code> (which conditions on size and
density). The equivalent functions in <code>sna</code> are
<code><a href="https://rdrr.io/pkg/sna/man/rgraph.html" class="external-link">sna::rgraph</a></code> and <code><a href="https://rdrr.io/pkg/sna/man/rgnm.html" class="external-link">sna::rgnm</a></code> (note that these
generate a matrix, rather than an <code>igraph</code> or
<code>network</code> graph). See <a href="#generate">the data generation
table</a> for these functions.</p>
<p>The second approach is to use a function that does the graph
generation and computes the network measure for you. The preferred is
<code><a href="https://rdrr.io/pkg/sna/man/cugtest.html" class="external-link">sna::cugtest</a></code>, which is specified as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/cug.test.html" class="external-link">cug.test</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">FUN</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"digraph"</span>, <span class="st">"graph"</span><span class="op">)</span>, cmode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"size"</span>,</span>
<span>    <span class="st">"edges"</span>, <span class="st">"dyad.census"</span><span class="op">)</span>, reps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    ignore.eval <span class="op">=</span> <span class="cn">TRUE</span>, FUN.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>See the <code>sna</code> help function for details.</p>
<p>Here</p>
<ul>
<li><p><code>FUN</code> is the function that needs to be calculated on
each graph</p></li>
<li><p><code>FUN.args</code> contains any arguments that are required
for the function you specified in <code>FUN</code></p></li>
<li>
<p><code>cmode</code> determines the type of graphs that are drawn
(ie. what you condition on). The options are</p>
<ul>
<li><p>“size”: this generates graphs with a particular size and density
0.5. You rarely want this.</p></li>
<li><p>“edges”: this conditions on a specific edge count (or an exact
edge value distribution)</p></li>
<li><p>“dyad.census”: this conditions on a dyad census (or dyad value
distribution)</p></li>
</ul>
</li>
</ul>
<p>For example, in order to test whether the transitivity in your graph
<code>g</code> is exceptional for a network of the same size and density
as in <code>g</code>, you would run</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/cug.test.html" class="external-link">cug.test</a></span><span class="op">(</span><span class="va">g</span>, <span class="fu">sna</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/sna/man/gtrans.html" class="external-link">gtrans</a></span>, cmode <span class="op">=</span> <span class="st">"edges"</span><span class="op">)</span></span></code></pre></div>
<p>It is wise to always explicitly tell the function whether your graph
is directed or not, so a better way to specify the previous function
is</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/cug.test.html" class="external-link">cug.test</a></span><span class="op">(</span><span class="va">g</span>, mode <span class="op">=</span> <span class="st">"graph"</span>, FUN <span class="op">=</span> <span class="fu">sna</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/sna/man/gtrans.html" class="external-link">gtrans</a></span>,</span>
<span>              cmode <span class="op">=</span> <span class="st">"edges"</span>, reps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>              FUN.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"graph"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Testing the betweenness centralization of you network <code>g</code>
could be performed as follows, again conditioning on size and
density:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/cug.test.html" class="external-link">cug.test</a></span><span class="op">(</span><span class="va">g</span>,</span>
<span>              <span class="fu">sna</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/sna/man/centralization.html" class="external-link">centralization</a></span>,</span>
<span>              FUN.arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="fu">sna</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/sna/man/betweenness.html" class="external-link">betweenness</a></span><span class="op">)</span>,</span>
<span>              mode<span class="op">=</span><span class="st">"graph"</span>,</span>
<span>              cmode<span class="op">=</span><span class="st">"edges"</span><span class="op">)</span></span></code></pre></div>
<p>There is also a useful <code>plot</code> method for the result of the
CUG test.</p>
<p><br></p>
<p>The huuuuuge downside of the <code>cug.test</code> function is that
it only takes specific input graps (perferably in matrix-format) and
only allows one to test with functions implemented within the
<code>sna</code> package. However, <code>snafun</code> can fix that. You
only need to construct a simple function with the following structure
<small>(yes, always start the function with
<code>x &lt;- snafun::fix_cug_input(x, directed = directed)</code>, this
fixes some peculiarities related to the <code><a href="https://rdrr.io/pkg/sna/man/cug.test.html" class="external-link">sna::cug.test</a></code>
function)</small>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trans_f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">directed</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">snafun</span><span class="fu">::</span><span class="fu"><a href="../reference/fix_cug_input.html">fix_cug_input</a></span><span class="op">(</span><span class="va">x</span>, directed <span class="op">=</span> <span class="va">directed</span><span class="op">)</span></span>
<span>  <span class="fu">snafun</span><span class="fu">::</span><span class="fu"><a href="../reference/gli.html">g_transitivity</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>and you can now test for transitivity with ANY graph that works with
<code>snafun::g_transitivity(x)</code> (which includes most formats
you’ll work with). Then, perform the CUG test as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/cug.test.html" class="external-link">cug.test</a></span><span class="op">(</span><span class="va">graph_object</span>, </span>
<span>              mode <span class="op">=</span> <span class="st">"graph"</span>, </span>
<span>              FUN <span class="op">=</span> <span class="va">trans_f</span>, </span>
<span>              cmode <span class="op">=</span> <span class="st">"edges"</span>, </span>
<span>              reps <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p>Et voila. It simply works.</p>
<p>Wanna use a more involved measure that doesn’t exist in the
<code>sna</code> package anyway? Sure, this is how you run a CUG test on
the number of walktrap communities in the graph:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">walk_num</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">directed</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">snafun</span><span class="fu">::</span><span class="fu"><a href="../reference/fix_cug_input.html">fix_cug_input</a></span><span class="op">(</span><span class="va">x</span>, directed <span class="op">=</span> <span class="va">directed</span><span class="op">)</span></span>
<span>  <span class="fu">snafun</span><span class="fu">::</span><span class="fu"><a href="../reference/extract_comm_walktrap.html">extract_comm_walktrap</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/cug.test.html" class="external-link">cug.test</a></span><span class="op">(</span><span class="va">graph_object</span>, mode <span class="op">=</span> <span class="st">"graph"</span>, FUN <span class="op">=</span> <span class="va">walk_num</span>, cmode <span class="op">=</span> <span class="st">"edges"</span>, reps <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p>As said, <code>snafun</code> puts the <em>FUN</em> straight into
SNA.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="qap-test">QAP test<a class="anchor" aria-label="anchor" href="#qap-test"></a>
</h3>
<p>There are two methods to perform a QAP test.</p>
<p>The first is to manually permute the graph. Generation of these
graphs can be done using <code><a href="https://r.igraph.org/reference/permute.html" class="external-link">igraph::permute</a></code> or
<code><a href="https://rdrr.io/pkg/sna/man/rmperm.html" class="external-link">sna::rmperm</a></code>. See <a href="#generate">the data generation
table</a> for these functions.</p>
<p>The second approach is to use a function that does the graph
permutation and computes the required measure (typically a correlation)
for you. The preferred is <code><a href="https://rdrr.io/pkg/sna/man/qaptest.html" class="external-link">sna::qaptest</a></code>, which is specified
as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/qaptest.html" class="external-link">qaptest</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">FUN</span>, reps <span class="op">=</span> <span class="fl">1000</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p>See the <code>sna</code> help function for details.</p>
<p>Here</p>
<ul>
<li><p><code>FUN</code> is the function that needs to be calculated
after each permutation</p></li>
<li><p><code>...</code> contains any arguments that are required for the
function you specified in <code>FUN</code></p></li>
</ul>
<p>Typically, you want to test the correlation between two graphs, as
follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/qaptest.html" class="external-link">qaptest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">firstNetwork</span>, <span class="va">secondNetwork</span><span class="op">)</span>,</span>
<span>             FUN <span class="op">=</span> <span class="fu">sna</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/sna/man/gcor.html" class="external-link">gcor</a></span>, reps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>             g1 <span class="op">=</span> <span class="fl">1</span>, g2 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>There is a useful <code>summary</code> method and a <code>plot</code>
method for the output of the function.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="qap-linear-regression">QAP linear regression<a class="anchor" aria-label="anchor" href="#qap-linear-regression"></a>
</h3>
<p>QAP linear regression is performed through the
<code><a href="https://rdrr.io/pkg/sna/man/netlm.html" class="external-link">sna::netlm</a></code> function. The function looks as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/netlm.html" class="external-link">netlm</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span>, mode <span class="op">=</span> <span class="st">"digraph"</span>,</span>
<span>    nullhyp <span class="op">=</span> <span class="st">"qapspp"</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Make sure to always set <code>intercept = TRUE</code> and
<code>nullhyp = "qapspp"</code>. For small networks, 1000 replications
should be enough, for larger networks you should typically use a higher
number (say, 2000).</p>
<p>As an example, this is how you specify a model where graph
<code>g</code> is modeled as a linear function of graphs
<code>g1</code>, <code>g2</code>, and <code>g3</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/netlm.html" class="external-link">netlm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">g</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, <span class="va">g3</span><span class="op">)</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              nullhyp <span class="op">=</span> <span class="st">'qapspp'</span>, reps <span class="op">=</span> <span class="fl">1001</span><span class="op">)</span></span>
<span><span class="va">mod</span><span class="op">$</span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intcpt"</span>, <span class="st">"Net1"</span>, <span class="st">"Net2"</span>, <span class="st">"Net3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p>It is wise to add the names of the networks to the output object,
like you see above. That is not strictly necessary, but it makes the
output of the function easier to read.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="qap-logistic-regression">QAP logistic regression<a class="anchor" aria-label="anchor" href="#qap-logistic-regression"></a>
</h3>
<p>QAP logistic regression is performed through the
<code><a href="https://rdrr.io/pkg/sna/man/netlogit.html" class="external-link">sna::netlogit</a></code> function. The function looks as follows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/netlogit.html" class="external-link">netlogit</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span>, mode <span class="op">=</span> <span class="st">"digraph"</span>,</span>
<span>    nullhyp <span class="op">=</span> <span class="st">"qapspp"</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Make sure to always set <code>intercept = TRUE</code> and
<code>nullhyp = "qapspp"</code>. For small networks, 1000 replications
should be enough, for larger networks you should typically use a higher
number (say, 2000).</p>
<p>As an example, this is how you specify a model where binary graph
<code>g</code> is modeled as a function of graphs <code>g1</code>,
<code>g2</code>, and <code>g3</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/netlogit.html" class="external-link">netlogit</a></span><span class="op">(</span><span class="va">g</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, <span class="va">g3</span><span class="op">)</span>,</span>
<span>                     intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     nullhyp <span class="op">=</span> <span class="st">"qapspp"</span>, reps <span class="op">=</span> <span class="fl">1001</span><span class="op">)</span></span>
<span><span class="va">mod</span><span class="op">$</span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intcpt"</span>, <span class="st">"Net1"</span>, <span class="st">"Net2"</span>, <span class="st">"Net3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.tilburguniversity.edu/staff/r-t-a-j-leenders" class="external-link">Roger Leenders</a>, <a href="https://www.tilburguniversity.edu/staff/c-zucca" class="external-link">Claudia Zucca</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
